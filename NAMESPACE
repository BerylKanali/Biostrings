useDynLib(Biostrings)

import(methods)
import(utils) ## for the "head" and "tail" generics
import(IRanges)
import(Biobase) ## for the "combine" generic

exportClasses(
    Views,
    Dups,
    SparseList,
    XRaw, XInteger, XNumeric,
    XString, BString, DNAString, RNAString, AAString,
    MaskedXString, MaskedBString, MaskedDNAString, MaskedRNAString, MaskedAAString,
    XStringViews,
    XStringSet, BStringSet, DNAStringSet, RNAStringSet, AAStringSet,
    XStringPartialMatches,
    InDel, AlignedXStringSet, QualityAlignedXStringSet,
    PairwiseAlignment, PairwiseAlignmentSummary,
    BOC_SubjectString, BOC2_SubjectString,
    PreprocessedTB, Twobit, ACtree, PDict3Parts, PDict, TB_PDict, MTB_PDict,
    MIndex, ByPos_MIndex, ByName_MIndex
)

export(
    readFASTA, writeFASTA, gregexpr2,
    IUPAC_CODE_MAP, mergeIUPACLetters,
    AMINO_ACID_CODE, GENETIC_CODE, RNA_GENETIC_CODE,
    DNA_ALPHABET, RNA_ALPHABET, AA_ALPHABET,
    #XRaw, XRaw.copy, XInteger, XInteger.read, XInteger.write, XNumeric, XNumeric.read, XNumeric.write,
    BString, DNAString, RNAString, AAString,
    BStringSet, DNAStringSet, RNAStringSet, AAStringSet,
    adjacentViews, trim, subviews,
    mask,
    FASTArecordsToCharacter, CharacterToFASTArecords,
    FASTArecordsToXStringViews, XStringSetToFASTArecords,
    read.XStringViews,
    read.BStringSet, read.DNAStringSet, read.RNAStringSet, read.AAStringSet,
    write.XStringSet, write.XStringViews,
    subXString, subviews,
    strrev, mkAllStrings,
    dinucleotideFrequency, trinucleotideFrequency, oligonucleotideTransitions,
    transcribe, cDNA, dna2rna, rna2dna,
    .inplaceReplaceLetterAtLoc,
    maxWeights, maxScore, PWMscore, matchPWM, countPWM,
    extractAllMatches,
    nucleotideSubstitutionMatrix, errorSubstitutionMatrices, qualitySubstitutionMatrices,

    ## Deprecated
    subBString,
    FASTArecordsToBStringViews,
    read.BStringViews, write.BStringViews,

    ## Defunct
    matchDNAPattern, alignScore
)

exportMethods(
    ## Generics defined elsewhere
    #as.integer, as.numeric,
    initialize, length, names, "[", "[[", rep,
    show, summary, "==", "!=", duplicated,
    coerce, as.matrix, as.list,
    as.character, toString, as.complex, toComplex,
    nchar,

    ## Methods for objects implementing an IRanges-like interface
    start, width, "width<-", end, isEmpty, max, min,
    narrow, reduce, gaps,

    ## SparseList objects
    ls,

    ## MaskedXString objects
    maskedwidth, maskedratio, 

    ## XString, XStringViews and MaskedXString objects
    XString, alphabet, subseq,
    XStringViews, subject, views,
    unmasked, masks, "masks<-",

    ## Utilities
    letter,
    substr, substring,
    alphabetFrequency, oligonucleotideFrequency,
    chartr,
    reverse, complement, reverseComplement,
    replaceLetterAtLoc,
    maskMotif,
    injectHardMask,

    ## Others
    nmismatchStartingAt, nmismatchEndingAt,
    isMatching, mismatch, nmatch, nmismatch,
    mismatchTable, mismatchSummary, coverage,
    matchPattern, countPattern,
    vcountPattern,
    matchLRPatterns,
    matchProbePair,
    findPalindromes,
    palindromeArmLength, palindromeLeftArm, palindromeRightArm,
    findComplementedPalindromes,
    complementedPalindromeArmLength, complementedPalindromeLeftArm, complementedPalindromeRightArm,

    head, tb, tb.width, tail, 
    patternFrequency,
    startIndex, endIndex, countIndex, combine, unlist,
    PDict, matchPDict, countPDict, whichPDict,

    subpatterns, pattern, insertion, deletion,
    unaligned, aligned, quality, type, score, indel, nindel,
    compareStrings, consmat,
    lcprefix, lcsuffix, pmatchPattern, lcsubstr,
    pairwiseAlignment, stringDist, needwunsQS,

    ## Deprecated
    BStringViews
)

